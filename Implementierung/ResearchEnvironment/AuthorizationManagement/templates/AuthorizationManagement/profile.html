{% extends "AuthorizationManagement/base.html" %}

{% block profil%}
	class="active";
{% endblock %}


{% block body %}

<style>
#first {
float:left;
}
#second {
float:left;
}
#third {
float:left;
}
</style>
<form action=/authentification/logout/>
			<input type=submit value="Logout">
		</form>	
		<h2>Profile ({{user.username}})</h1>

		
  
		<p><strong>Name:</strong> {{ user.first_name }} {{user.last_name}} </p>
		<p><strong>E-mail:</strong> {{ user.email }}</p>
		<p><strong>Joined on:</strong> {{ user.date_joined }}</p>  
		
		<div id="first">
		<form action="/profile">
			<input type=submit value="Requests">
		</form>
		</div>

        <div id="second">
		<form action="/profile/my-resources">
			<input type=submit value="My Resources">
		</form>
		</div> <br/>
	
	{% block profile %}
			{% if is_admin %}
			<h3>Access requests</h3>
			{% endif %}
			{% for accessrequest in accessrequest_list %}
			    <p> From: {{accessrequest.sender.username}} </p>
				<p> For: {{accessrequest.resource.name}} </p>
				<p> Description: {{accessrequest.description}} </p>
				
			    <button style=" margin-left:10px;">
				<a href="#approve-request-{{accessrequest.pk}}" > accept </a>
				</button>
								
				<div id="approve-request-{{accessrequest.pk}}" class="modalDialog">
					<div>
						<a href="" title="Close" class="close"> x </a>
						<form action="/approve-access-request/{{accessrequest.pk}}" method="post">
						{% csrf_token %}
							
							<div class="row">
								<label for="desc">Description: </label><br><br>									
                                <textarea id="descr" name = "descr" placeholder="optional" maxlength="250" cols = "50" rows = "5"></textarea>
                            </div>
							<div class="row">
								<p> Are you sure you want to approve the access request for {{accessrequest.resource.name}}? </p>
								<input id="yes" type="submit" value="yes, allow permissions">
								<button>
									<a href="" title="close" class="close"> close </a>
								</button>
							</div>
						</form>
					</div>
				</div>
						
				<button style=" margin-left:10px;">
				<a href="#deny-request-{{accessrequest.pk}}" > deny </a>
				</button>
								
				<div id="deny-request-{{accessrequest.pk}}" class="modalDialog">
					<div>
						<a href="" title="Close" class="close"> x </a>
						<form action="/deny-access-request/{{accessrequest.pk}}" method="post">
						{% csrf_token %}
							
							<div class="row">									
                                <label for="desc">Description: </label><br><br>		                                    
                                <textarea id="descr" name = "descr" placeholder="optional" maxlength="250" cols = "50" rows = "5"></textarea>                                    
                            </div>
							<div class "row">
								<p> Are you sure you want to deny the access request for {{accessrequest.resource.name}}? </p>
								<input id="yes" type="submit" value="yes, deny permission">
								<button>
									<a href="" title="close" class="close"> close </a>
								</button>
							</div>
						</form>
					</div>
				</div>
				{% load static %}
				<link rel="stylesheet" type="text/css" href="{% static 'AuthorizationManagement/css/handle_req.css' %}" />

            {% endfor %}
            
            {% if is_admin %}
            <h3>Deletion requests</h3>
	{% for deletionrequest in deletionrequest_list %}
			    <p> From: {{deletionrequest.sender.username}} </p>
				<p> For: {{deletionrequest.resource.name}} </p>
				<p> Description: {{deletionrequest.description}} </p>
				
			    <button style=" margin-left:10px;">
				<a href="#approve-request-{{deletionrequest.pk}}" > accept </a>
				</button>
								
				<div id="approve-request-{{deletionrequest.pk}}" class="modalDialog">
					<div>
						<a href="" title="Close" class="close"> x </a>
						<form action="/approve-deletion-request/{{deletionrequest.pk}}" method="post">
						{% csrf_token %}
							
							<div class="row">
								<label for="desc">Description: </label><br><br>									
                                <textarea id="descr" name = "descr" placeholder="optional" maxlength="250" cols = "50" rows = "5"></textarea>
                            </div>
							<div class="row">
								<p> Are you sure you want to delete {{deletionrequest.resource.name}}? </p>
								<input id="yes" type="submit" value="yes, delete resource">
								<button>
									<a href="" title="close" class="close"> close </a>
								</button>
							</div>
						</form>
					</div>
				</div>
						
				<button style=" margin-left:10px;">
				<a href="#deny-request-{{deletionrequest.pk}}" > deny </a>
				</button>
								
				<div id="deny-request-{{deletionrequest.pk}}" class="modalDialog">
					<div>
						<a href="" title="Close" class="close"> x </a>
						<form action="/deny-deletion-request/{{deletionrequest.pk}}" method="post">
						{% csrf_token %}
							
							<div class="row">									
                                <label for="desc">Description: </label><br><br>		                                    
                                <textarea id="descr" name = "descr" placeholder="optional" maxlength="250" cols = "50" rows = "5"></textarea>                                    
                            </div>
							<div class=row">
								<p> Are you sure you want to deny the deletion request for {{deletionrequest.resource.name}}? </p>
								<input id="yes" type="submit" value="yes, deny deletion">
								<button>
									<a href="" title="close" class="close"> close </a>
								</button>
							</div>
						</form>
					</div>
				</div>
				{% load static %}
				<link rel="stylesheet" type="text/css" href="{% static 'AuthorizationManagement/css/handle_req.css' %}" />

            {% endfor %}
            {% endif %}

	{% endblock %}
		
{% endblock %}	